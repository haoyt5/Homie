(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{242:function(e,t,a){},373:function(e,t,a){e.exports=a(786)},786:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(35),o=a.n(s),c=(a(242),a(9)),i=a(10),l=a(12),u=a(11),m=a(13),p=a(27),d=a(75),h=a(17),g=a(18),f=a(19),E=a(382),b=function(){return function(e,t,a){var n,r,s=a.getFirebase,o=a.getFirestore,c=s(),i=o(),l=new c.auth.GoogleAuthProvider,u=E({luminosity:"bright"});c.auth().signInWithPopup(l).then(function(t){var a=t.additionalUserInfo.profile,s=a.given_name,o=a.family_name,c=a.picture,l=a.email;if(t.additionalUserInfo.isNewUser){n=s||" ",r=o||" ";var m=t.user;i.collection("users").doc(m.uid).set({firstname:s||"",lastname:o||"",initials:n[0]+r[0],photoURL:c,email:l,createAt:i.FieldValue.serverTimestamp(),userColor:u}).then(function(){return window.location.hash="#/signgroup/signup"}).then(function(){return e({type:"LOGIN_SUCCESS"})}).catch(function(t){console.log(t),e({type:"LOGIN_ERROR"},t)})}else i.collection("users").where("email","==",l).get().then(function(t){t.forEach(function(t){t.data().defaultGroup||null?(e({type:"LOGIN_SUCCESS"}),window.location.hash="#/"):(e({type:"LOGIN_SUCCESS"}),window.location.hash="#/signgroup/signup")})}),e({type:"LOGIN_SUCCESS"})}).catch(function(t){console.log("error",t),e({type:"LOGIN_ERROR",error:t})})}},v=Object(h.b)(null,function(e){return{signOut:function(){return e(function(e,t,a){(0,a.getFirebase)().auth().signOut().then(function(){e({type:"SIGNOUT_SUCCESS"})}).then(function(){window.location.hash="#/"})})}}})(function(e){var t=e.profile;return r.a.createElement("div",{className:"signinwrapper"},r.a.createElement(p.c,{to:"/signgroup/signin",className:"link-button"},"Join group"),r.a.createElement(p.c,{to:"/",className:"link-button",onClick:e.signOut},"Log out"),r.a.createElement(p.c,{to:"/",className:"avatar-circle"},t.initials))}),N=function(){return r.a.createElement("div",{className:"signinwrapper"},r.a.createElement(p.c,{to:"/signup",className:"link-button"},"Sign up"),r.a.createElement(p.c,{to:"/signin",className:"link-button "},"Log in"))},k=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.auth,a=e.profile,n=t.uid?r.a.createElement(v,{profile:a}):r.a.createElement(N,null);return r.a.createElement("nav",{className:"navwrapper"},r.a.createElement("div",{className:"container"},r.a.createElement(p.b,{to:"/",className:"brandname"},"HOMIE"),n))}}]),t}(n.Component),y=Object(h.b)(function(e){return{auth:e.firebase.auth,profile:e.firebase.profile}})(k),O=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:""},a.handleChange=function(e){a.setState(Object(f.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.props.signIn(a.state)},a.handleGoogleLogin=function(e){a.props.googleLogin()},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.auth,a=e.profile;return t.uid&&!a.defaultGroup?r.a.createElement(d.a,{to:"/signgroup/signup"}):t.uid&&a.defaultGroup?r.a.createElement(d.a,{to:"/"}):void 0}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this.props.authError;return r.a.createElement("div",{className:"container"},r.a.createElement("h2",{className:"sub-instruciton-title"},"Member Login"),r.a.createElement("div",{className:"formoutter"},r.a.createElement("div",{className:"formwrapper"},r.a.createElement("div",{className:"button-row"},r.a.createElement("button",{onClick:this.handleGoogleLogin,className:"google-button"},r.a.createElement("div",{className:"login-icon"},"G"),r.a.createElement("div",{className:"login-text"},"Continue with Google"))),r.a.createElement("div",{className:"feature-row"},r.a.createElement("div",{className:"hr-box "},r.a.createElement("div",{className:"hr-placer"},"\u2014\u2014\u2014"),r.a.createElement("div",{className:"hr"},"OR"),r.a.createElement("div",{className:"hr-placer"},"\u2014\u2014\u2014"))),r.a.createElement("form",{className:"signinform",onSubmit:this.handleSubmit},r.a.createElement("label",{className:"label-font",htmlFor:"email"},"Email"),r.a.createElement("div",{className:"input-row"},r.a.createElement("input",{type:"email",id:"email",onChange:this.handleChange})),r.a.createElement("label",{className:"label-font",htmlFor:"password"},"Password"),r.a.createElement("div",{className:"input-row"},r.a.createElement("input",{type:"password",id:"password",onChange:this.handleChange})),r.a.createElement("div",{className:"text-row error-holder"},e?r.a.createElement("p",{className:"alert-font"},e):null),r.a.createElement("div",{className:"feature-row"},r.a.createElement("button",{className:"medium-button"},"Log in"))))))}}]),t}(n.Component),w=Object(h.b)(function(e){return{authError:e.auth.authError,auth:e.firebase.auth,profile:e.firebase.profile}},function(e){return{signIn:function(t){return e((a=t,function(e,t,n){(0,n.getFirebase)().auth().signInWithEmailAndPassword(a.email,a.password).then(function(){e({type:"LOGIN_SUCCESS"})}).then(function(){window.location.hash="#/"}).catch(function(t){e({type:"LOGIN_ERROR",err:t})})}));var a},googleLogin:function(){return e(b())}}})(O),T=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:"",firstName:"",lastName:""},a.handleChange=function(e){a.setState(Object(f.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.props.signUp(a.state)},a.handleGoogleLogin=function(e){a.props.googleLogin()},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.auth,a=e.authError;return t.uid?r.a.createElement(d.a,{to:"/"}):r.a.createElement("div",{className:"container"},r.a.createElement("h2",{className:"sub-instruciton-title"},"Start with Homie"),r.a.createElement("div",{className:"formoutter"},r.a.createElement("div",{className:"formwrapper"},r.a.createElement("div",{className:"button-row"},r.a.createElement("button",{onClick:this.handleGoogleLogin,className:"google-button"},r.a.createElement("div",{className:"login-icon"},"G"),r.a.createElement("div",{className:"login-text"},"Sign up with Google"))),r.a.createElement("div",{className:"feature-row"},r.a.createElement("div",{className:"hr-box "},r.a.createElement("div",{className:"hr-placer"},"\u2014\u2014\u2014"),r.a.createElement("div",{className:"hr"},"OR"),r.a.createElement("div",{className:"hr-placer"},"\u2014\u2014\u2014"))),r.a.createElement("form",{className:"signinform",onSubmit:this.handleSubmit},r.a.createElement("label",{className:"label-font",htmlFor:"email"},"Email"),r.a.createElement("div",{className:"input-row"},r.a.createElement("input",{type:"email",id:"email",onChange:this.handleChange})),r.a.createElement("label",{className:"label-font",htmlFor:"password"},"Password"),r.a.createElement("div",{className:"input-row"},r.a.createElement("input",{type:"password",id:"password",onChange:this.handleChange})),r.a.createElement("label",{className:"label-font",htmlFor:"firstName"},"First name"),r.a.createElement("div",{className:"input-row"},r.a.createElement("input",{type:"text",id:"firstName",onChange:this.handleChange})),r.a.createElement("label",{className:"label-font",htmlFor:"lastName"},"Last name"),r.a.createElement("div",{className:"input-row"},r.a.createElement("input",{type:"text",id:"lastName",onChange:this.handleChange})),r.a.createElement("div",{className:"text-row error-holder"},a?r.a.createElement("p",{className:"alert-font"},a):null),r.a.createElement("div",{className:"feature-row"},r.a.createElement("button",{className:"medium-button"},"Sign Up"))))))}}]),t}(n.Component),S=Object(h.b)(function(e){return{auth:e.firebase.auth,authError:e.auth.authError}},function(e){return{signUp:function(t){return e(function(e){return function(t,a,n){var r=n.getFirebase,s=n.getFirestore,o=r(),c=s(),i=E({luminosity:"bright"});o.auth().createUserWithEmailAndPassword(e.email,e.password).then(function(t){return c.collection("users").doc(t.user.uid).set({firstname:e.firstName,lastname:e.lastName,initials:e.firstName[0]+e.lastName[0],email:e.email,createAt:c.FieldValue.serverTimestamp(),photoURL:null,userColor:i})}).then(function(){o.auth().currentUser.updateProfile({displayName:e.firstName,email:e.email,createAt:c.FieldValue.serverTimestamp()})}).then(function(){t({type:"SIGNUP_SUCCESS"})}).then(function(){window.location.hash="#/signgroup/signup"}).catch(function(e){t({type:"SIGNUP_ERROR",err:e})})}}(t))},googleLogin:function(){return e(b())}}})(T),j=a(20),D=a(21),C=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"empty-card"},r.a.createElement("div",{className:"bouncing-loader"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))))}}]),t}(n.Component),G=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"empty-card"}))}}]),t}(n.Component),U=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.completeTasks,a=e.pendingTasks,n=e.assignedTasks,s=e.unassignedTasks;return r.a.createElement("div",{className:"tasklist-wapper"},r.a.createElement("div",{className:"title-row"},r.a.createElement("h3",{className:"row-title"},"UNASSIGNED"),r.a.createElement(p.b,{to:"/post",className:"row-icon icon-row-button"},r.a.createElement("h3",null,r.a.createElement(j.a,{icon:D.i})),r.a.createElement("p",null,"Add another task"))),this.props.fetchComplete?this.props.unassignedTasks[0]?r.a.createElement("div",{className:"container "},s&&s.map(function(e){return r.a.createElement(p.b,{className:"card-hover",to:"/task/"+e.id,key:e.id,task:e},r.a.createElement("div",{className:"task-card card-hover"},r.a.createElement("div",{className:"card-row"},r.a.createElement("div",{className:"col-pic"},r.a.createElement("div",{className:"card-img-box u-dashed-border"},r.a.createElement("div",{className:"card-img-box-inner"},r.a.createElement("div",{className:"card-img-holder"},r.a.createElement("p",null,r.a.createElement(j.a,{icon:D.j})))))),r.a.createElement("div",{className:"col-info"},r.a.createElement("div",{className:"info-title-row"},r.a.createElement("h3",{className:"card-title"},e.data.title),r.a.createElement("div",{className:"create-tag"},r.a.createElement("p",{className:"card-create-time"},e.data.createAt.toDate().toDateString()),r.a.createElement("p",{className:"author-tag"},e.data.author," "))),0!==e.data.content.length?r.a.createElement("p",{className:"info-content"},e.data.content):r.a.createElement("p",{className:"info-content u-invisible"}," -- "),r.a.createElement("div",{className:"info-end-row"},e.data.verifybyImage?r.a.createElement("p",{className:"expiry-tag"},r.a.createElement("div",{className:"tag-icon"},r.a.createElement(j.a,{icon:D.b})),r.a.createElement("div",{className:"tag-date"},"proof needed")):null,r.a.createElement("p",{className:"expiry-tag"},r.a.createElement("div",{className:"tag-icon"},r.a.createElement(j.a,{icon:D.l})),r.a.createElement("div",{className:"tag-date"},e.data.expiryDate.toDate().toDateString())))))))})):r.a.createElement(G,null):r.a.createElement(C,null),r.a.createElement("div",{className:"title-row"},r.a.createElement("h3",{className:"row-title"},"ASSIGNED")),this.props.fetchComplete?this.props.assignedTasks[0]?r.a.createElement("div",{className:"container "},n&&n.map(function(e){return r.a.createElement(p.b,{to:"/task/memo/"+e.id,key:e.id,task:e},r.a.createElement("div",{className:"task-card card-hover"},r.a.createElement("div",{className:"card-row"},r.a.createElement("div",{className:"col-pic"},r.a.createElement("div",{className:"card-img-box "},r.a.createElement("div",{className:"card-img-box-inner"},null!==e.data.assign.assignedToURL?r.a.createElement("img",{className:"card-img-holder",src:e.data.assign.assignedToURL,alt:""}):r.a.createElement("div",{className:"card-img-holder",style:{backgroundColor:e.data.assign.assignedToColor}},r.a.createElement("p",null,e.data.assign.assignedTo[0]))))),r.a.createElement("div",{className:"col-info"},r.a.createElement("div",{className:"info-title-row"},r.a.createElement("h3",{className:"card-title"},e.data.title),r.a.createElement("div",{className:"create-tag"},r.a.createElement("p",{className:"card-create-time"},e.data.createAt.toDate().toDateString()),r.a.createElement("p",{className:"author-tag"},e.data.author," "))),0!==e.data.content.length?r.a.createElement("p",{className:"info-content"},e.data.content):r.a.createElement("p",{className:"info-content u-invisible"}," -- "),r.a.createElement("div",{className:"info-end-row"},e.data.verifybyImage?r.a.createElement("div",{className:"expiry-tag"},r.a.createElement("div",{className:"tag-icon"},r.a.createElement(j.a,{icon:D.b})),r.a.createElement("div",{className:"tag-date"},"proof needed")):null,r.a.createElement("div",{className:"expiry-tag"},r.a.createElement("div",{className:"tag-icon"},r.a.createElement(j.a,{icon:D.l})),r.a.createElement("div",{className:"tag-date"},e.data.expiryDate.toDate().toDateString())))))))})):r.a.createElement(G,null):r.a.createElement(C,null),r.a.createElement("div",{className:"title-row"},r.a.createElement("h3",{className:"row-title"},"PENDING APPROVAL")),this.props.fetchComplete?this.props.pendingTasks[0]?r.a.createElement("div",{className:"container "},a&&a.map(function(e){return r.a.createElement(p.b,{to:"/task/process/"+e.id,key:e.id,task:e},r.a.createElement("div",{className:"task-card card-hover"},r.a.createElement("div",{className:"card-row"},r.a.createElement("div",{className:"col-pic"},r.a.createElement("div",{className:"card-img-box "},r.a.createElement("div",{className:"card-img-box-inner"},null!==e.data.assign.assignedToURL?r.a.createElement("img",{className:"card-img-holder",src:e.data.assign.assignedToURL,alt:""}):r.a.createElement("div",{className:"card-img-holder",style:{backgroundColor:e.data.assign.assignedToColor}},r.a.createElement("p",null,e.data.assign.assignedTo[0]))))),r.a.createElement("div",{className:"col-info"},r.a.createElement("div",{className:"info-title-row"},r.a.createElement("h3",{className:"card-title"},e.data.title),r.a.createElement("div",{className:"create-tag"},r.a.createElement("p",{className:"card-create-time"},e.data.createAt.toDate().toDateString()),r.a.createElement("p",{className:"author-tag"},e.data.author," "))),0!==e.data.content.length?r.a.createElement("p",{className:"info-content"},e.data.content):r.a.createElement("p",{className:"info-content u-invisible"}," -- "),r.a.createElement("div",{className:"info-end-row"},e.data.verifybyImage?r.a.createElement("div",{className:"expiry-tag"},r.a.createElement("div",{className:"tag-icon"},r.a.createElement(j.a,{icon:D.b})),r.a.createElement("div",{className:"tag-date"},"proof needed")):null,r.a.createElement("div",{className:"expiry-tag"},r.a.createElement("div",{className:"tag-icon"},r.a.createElement(j.a,{icon:D.l})),r.a.createElement("div",{className:"tag-date"},e.data.expiryDate.toDate().toDateString())))))))})):r.a.createElement(G,null):r.a.createElement(C,null),r.a.createElement("div",{className:"title-row"},r.a.createElement("h3",{className:"row-title"},"COMPLETE")),this.props.fetchComplete?this.props.completeTasks[0]?r.a.createElement("div",{className:"container "},t&&t.map(function(e){return r.a.createElement("div",{className:"task-card ",key:e.id},r.a.createElement("div",{className:"card-row"},r.a.createElement("div",{className:"col-pic"},r.a.createElement("div",{className:"card-img-box "},r.a.createElement("div",{className:"card-img-box-inner"},null!==e.data.assign.assignedToURL?r.a.createElement("img",{className:"card-img-holder",src:e.data.assign.assignedToURL,alt:""}):r.a.createElement("div",{className:"card-img-holder",style:{backgroundColor:e.data.assign.assignedToColor}},r.a.createElement("p",null,e.data.assign.assignedTo[0]))))),r.a.createElement("div",{className:"col-info"},r.a.createElement("div",{className:"info-title-row"},r.a.createElement("h3",{className:"card-title"},e.data.title),r.a.createElement("div",{className:"create-tag"},r.a.createElement("p",{className:"card-create-time"},e.data.createAt.toDate().toDateString()),r.a.createElement("p",{className:"author-tag"},e.data.author," "))),0!==e.data.content.length?r.a.createElement("p",{className:"info-content"},e.data.content):r.a.createElement("p",{className:"info-content u-invisible"}," -- "),r.a.createElement("div",{className:"info-end-row"},e.data.verifybyImage?r.a.createElement("div",{className:"expiry-tag"},r.a.createElement("div",{className:"tag-icon"},r.a.createElement(j.a,{icon:D.b})),r.a.createElement("div",{className:"tag-date"},"proof needed")):null,r.a.createElement("div",{className:"expiry-tag"},r.a.createElement("div",{className:"tag-icon"},r.a.createElement(j.a,{icon:D.l})),r.a.createElement("div",{className:"tag-date"},e.data.expiryDate.toDate().toDateString()))))))})):r.a.createElement(G,null):r.a.createElement(C,null))}}]),t}(n.Component),R=a(116),A=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(){0!==this.props.data.length&&this.drawChart()}},{key:"drawChart",value:function(){var e=5,t=3,a=100-t-3,n=100-e-5,r=R.d("#chart").append("svg").attr("width","100%").attr("height","100%").append("g").attr("width",a+"%").attr("height",n+"%").style("transform","translate(".concat(t,"% ,").concat(e,"% )")).selectAll("rect").data(this.props.data),s=R.a(this.props.data,function(e){return e.points});s<5&&(s=5);var o=R.c().domain([0,s]).range([0,a]),c=R.b().domain(this.props.data.map(function(e){return e.firstname})).range([n,0]).padding(.5);r.enter().append("rect").attr("height",c.bandwidth()+"%").attr("width",function(e,t){return o(e.points)+"%"}).attr("y",function(e,t){return c(e.firstname)+"%"}).attr("x",function(e,t){return 0}).attr("fill",function(e,t){return e.userColor}).attr("radius",5),r.enter().append("text").style("font-size","0.8rem").style("font-weight","bold").attr("fill","#a5a5a5").attr("height",c.bandwidth()+"%").attr("width",function(e,t){return o(e.points)+"%"}).attr("y",function(e,t){return c(e.firstname)-2+"%"}).attr("x",0).text(function(e){return"".concat(e.firstname," : ").concat(e.points," points")}).style("backgroud-color","white")}},{key:"render",value:function(){return r.a.createElement("div",{className:"barchart-box"},r.a.createElement("div",{className:"barchart-inner"},r.a.createElement("div",{id:"chart"})))}}]),t}(n.Component),I=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"welcome-wrapper"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"col-2-1"},r.a.createElement("div",{className:"logo-block"},r.a.createElement("div",{className:"logo-holder expand-effect"},r.a.createElement("h2",null,"\u25cf\xb4\u2200`\u25cf")))),r.a.createElement("div",{className:"col-2-1"},r.a.createElement("div",{className:"campaign-block"},r.a.createElement("h1",{className:"campaign-block-title "},"Start from ",r.a.createElement("span",{className:"brand"},"HOMIE"),r.a.createElement("br",null)," Arrange houseworks easier."),r.a.createElement("p",{className:""},"Manage, collaborate and track the houseworks smart.  ")))))}}]),t}(n.Component),P=a(65),x=function(e){return function(t,a,n){var r,s=(0,n.getFirestore)();e?s.collection("users").doc(e).get().then(function(e){return e.data().defaultGroup||null}).then(function(e){e?s.collection("groups").doc(e).get().then(function(e){r=e.data()}).then(function(){t({type:"GET_GROUP",groupData:r})}):t({type:"GET_GROUP_EMPTY"})}):(console.log("EMPTY"),t({type:"GET_GROUP_EMPTY"}))}},F=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleSwitch=function(e){a.props.switchGroup(e),a.props.togglePopup(),a.props.fetchGroupDetails()},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(){}},{key:"componentWillMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props.groupsData;return r.a.createElement("div",{className:"popup"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"close-popup-row",onClick:this.props.togglePopup},r.a.createElement(j.a,{icon:D.g}))),r.a.createElement("div",{className:"option-block"},t&&t.map(function(t){var a=t.groupUid,n=t.groupName;return r.a.createElement("div",{onClick:function(){return e.handleSwitch(a)},className:"option-row ",key:a},r.a.createElement("div",{className:"option-icon"},r.a.createElement(j.a,{icon:D.d})),r.a.createElement("div",{className:"option-text"},n))})),r.a.createElement("div",{className:"u-bottom"},r.a.createElement("div",{className:"container"},r.a.createElement(p.c,{to:"/signgroup/signin"},r.a.createElement("div",{className:"option-row "},r.a.createElement("div",{className:"option-icon"},r.a.createElement(j.a,{icon:D.h})),r.a.createElement("div",{className:"option-text"},"Join new group")))))))}}]),t}(n.Component),_=Object(h.b)(function(e){return{groupsUid:e.firebase.profile.groupsUid,defaultGroup:e.firebase.profile.defaultGroup}},function(e){return{switchGroup:function(t){return e(function(e){return function(t,a,n){var r=n.getFirestore,s=a().firebase.auth.uid;r().collection("users").doc(s).update({defaultGroup:e}).then(t({type:"SWITCHGROUP_SUCCESS"})).catch(function(e){t({type:"SWITCHGROUP_ERROR",error:e})})}}(t))},fetchGroupDetails:function(t){return e(x(t))}}})(F),L=a(165),B=a.n(L);a(459),a(463),a(787);B.a.initializeApp({apiKey:"AIzaSyAPYaJoMlKsJ6iepxr8uWw4ZE1aPlH6rvI",authDomain:"homie-2019.firebaseapp.com",databaseURL:"https://homie-2019.firebaseio.com",projectId:"homie-2019",storageBucket:"homie-2019.appspot.com"});var M=B.a.storage(),K=function(e){return function(t,a,n){n.getFirebase;var r,s=(0,n.getFirestore)();e?s.collection("tasks").doc(e).get().then(function(e){r={id:e.id,data:e.data()}}).then(function(){t({type:"GET_TASK",taskData:r})}).catch(function(e){console.log(e),t({type:"EMPTY_TASK"})}):t({type:"EMPTY_TASK"})}},V=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleConfirm=function(){a.props.leaveGroup()},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"popup-layer"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"information-window"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"alert-icon browncolor-icon"},r.a.createElement(j.a,{icon:D.k})),r.a.createElement("h2",null,"Warning"),r.a.createElement("h4",null,"Are you sure to leave this group? All your records in this group will be deleted."),r.a.createElement("hr",null)),r.a.createElement("div",{className:"feature-row"},r.a.createElement("button",{className:"small-square-button cancel-button",onClick:this.props.toggleLeaveGroup},"Dismiss"),r.a.createElement("button",{className:"small-square-button",onClick:this.handleConfirm},"Confirm")))))}}]),t}(n.Component),W=Object(h.b)(null,function(e){return{confirmTaskAlert:function(){return e(function(e,t,a){a.getFirebase,a.getFirestore,e({type:"RESET_TASK_ALERT"})})},leaveGroup:function(){return e(function(e,t,a){a.getFirebase;var n,r=(0,a.getFirestore)(),s=t().firebase.auth.uid,o=t().firebase.profile,c=o.defaultGroup,i=o.groupsUid,l=null,u=i.filter(function(e){return e!==c});c&&r.collection("groups").doc(c).update((n={members:r.FieldValue.arrayRemove(s)},Object(f.a)(n,"membersInfo.".concat(s),r.FieldValue.delete()),Object(f.a)(n,"pointsRecord.".concat(s),r.FieldValue.delete()),n)).then(function(){0===u.length?(l=null,r.collection("users").doc(s).update({groupsUid:u,defaultGroup:l}).then(function(){window.location.hash="#/signgroup/signin"}).catch(function(e){return console.log(e)})):r.collection("users").doc(s).update({groupsUid:u,defaultGroup:u[0]}).then(function(){window.location="/"}).catch(function(e){return console.log(e)})}).catch(function(e){return console.log(e)})})}}})(V),Y=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={groupPopup:!1,leavePopup:!1,memberBar:!1,settingBar:!1},a.togglePopup=function(){a.state.groupPopup||a.props.profile.defaultGroup&&(a.props.fetchGroupList(a.props.groupsUid),a.props.fetchTaskList(),a.props.fetchGroupDetails()),a.state.groupPopup&&a.props.profile.defaultGroup&&(a.props.fetchTaskList(a.props.auth.uid),a.props.fetchGroupDetails(a.props.auth.uid)),a.setState(function(e){return{groupPopup:!e.groupPopup}})},a.toggleSettingBar=function(){a.setState(function(e){return{settingBar:!e.settingBar}}),a.state.memberBar&&a.setState(function(e){return{memberBar:!e.memberBar}})},a.toggleMemberbar=function(){a.setState(function(e){return{memberBar:!e.memberBar}}),a.state.settingBar&&a.setState(function(e){return{settingBar:!e.settingBar}})},a.toggleLeaveGruop=function(e){a.setState(function(e){return{leavePopup:!e.leavePopup}})},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.auth.uid&&(this.props.fetchTaskList(this.props.auth.uid),this.props.fetchGroupDetails(this.props.auth.uid))}},{key:"componentWillUnmount",value:function(){console.log("unmount dashboard EMPTY"),this.props.fetchGroupDetails(),this.props.fetchTaskList()}},{key:"render",value:function(){var e=this.props,t=e.membersInfo,a=e.completeTasksData,n=e.pendingTasksData,s=e.assignedTasksData,o=e.unassignedTasksData,c=e.tasksData,i=e.auth,l=[],u=this.props.membersPointsRecord;return this.props.membersPointsRecord&&Object.keys(u).forEach(function(e){l.push(u[e])}),i.uid?r.a.createElement("div",{className:"dashboard-wrapper"},this.state.groupPopup?r.a.createElement(_,{togglePopup:this.togglePopup.bind(this),groupsData:this.props.groupsData}):null,this.state.leavePopup?r.a.createElement(W,{toggleLeaveGroup:this.toggleLeaveGruop.bind(this)}):null,r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"selected-wrapper"},r.a.createElement("div",{className:"selected-group",onClick:this.togglePopup},this.props.defaultGroupData?this.props.defaultGroupData.groupName:null," ",r.a.createElement(j.a,{icon:D.a}))),r.a.createElement("div",{className:"indicator-wrapper"},r.a.createElement("div",{className:"icon-bar"},r.a.createElement("div",{onClick:this.toggleSettingBar,className:"indicator-button "},r.a.createElement(j.a,{icon:D.c})),r.a.createElement("div",{onClick:this.toggleMemberbar,className:"indicator-button "},r.a.createElement(j.a,{icon:D.n})," ",this.props.defaultGroupData?this.props.defaultGroupData.members.length:1)),this.state.memberBar?r.a.createElement("div",{className:"member-bar"},t?Object.keys(t).map(function(e){return r.a.createElement("div",{className:"member-button",key:e},r.a.createElement("div",{className:"member-cirle"},r.a.createElement("div",{className:"circle-wrapper"},"null"===t[e].photoURL?r.a.createElement("div",{className:"member-img-holder"}," ",r.a.createElement(j.a,{icon:D.o})," "):r.a.createElement("img",{src:t[e].photoURL,alt:""}))),r.a.createElement("span",{className:"circle-name"},t[e].firstname))}):null):null,this.state.settingBar?r.a.createElement("div",{className:"setting-bar"},r.a.createElement(p.b,{to:"/signgroup/signin"},r.a.createElement("div",{className:"setting-button"},r.a.createElement(j.a,{icon:D.e}),"  Join new group")),r.a.createElement("div",{onClick:this.toggleLeaveGruop,className:"setting-button"},r.a.createElement(j.a,{icon:D.m})," Leave this group")):null)),r.a.createElement("div",{className:"container"},this.state.groupPopup||this.state.leavePopup?null:r.a.createElement(A,{data:this.props.pointsData,width:this.state.width,height:this.state.height})),r.a.createElement("div",{className:"container"},this.state.groupPopup||this.state.leavePopup?null:r.a.createElement(U,{fetchComplete:this.props.fetchComplete,task:c,unassignedTasks:o,assignedTasks:s,pendingTasks:n,completeTasks:a}))):r.a.createElement("div",{className:"landing-wrapper"},r.a.createElement(I,null))}}]),t}(n.Component),q=Object(h.b)(function(e){var t=[],a=e.group.defaultGroupData?e.group.defaultGroupData.pointsRecord:null;a&&Object.keys(a).forEach(function(e){t.push(a[e])});var n=e.group.defaultGroupData?e.group.defaultGroupData:null,r=e.firebase.auth?e.firebase.auth:null,s=e.group.defaultGroupData?e.group.defaultGroupData.membersInfo:null,o=e.group.defaultGroupData?e.group.defaultGroupData.pointsRecord:null;return{tasks:e.firestore.ordered.tasks,auth:r,groupsUid:e.firebase.profile.groupsUid,groupsData:e.group.groups,profile:e.firebase.profile,defaultGroupData:n,membersInfo:s,membersPointsRecord:o,tasksData:e.task.tasksData,unassignedTasksData:e.task.unassignedTasksData,assignedTasksData:e.task.assignedTasksData,pendingTasksData:e.task.pendingTasksData,completeTasksData:e.task.completeTasksData,pointsData:t,fetchComplete:e.task.complete}},function(e){return{fetchGroupList:function(t){return e(function(e){return function(t,a,n){n.getFirebase;var r=n.getFirestore,s=[],o=r();e.map(function(e){return o.collection("groups").doc(e).get().then(function(e){s=[].concat(Object(P.a)(s),[e.data()])}).then(function(){t({type:"GROUP_ADD",groupsData:s})})})}}(t))},fetchTaskList:function(t){return e(function(e){return function(t,a,n){n.getFirebase;var r=(0,n.getFirestore)(),s=[],o=[],c=[],i=[],l=[];e?r.collection("users").doc(e).get().then(function(e){return e.data().defaultGroup||null}).then(function(e){e&&r.collection("tasks").where("groupUid","==",e).orderBy("lastUpdateAt","desc").get().then(function(e){e.forEach(function(e){s=[].concat(Object(P.a)(s),[{id:e.id,data:e.data()}])})}).then(function(){r.collection("tasks").where("groupUid","==",e).where("status","==","unassigned").orderBy("lastUpdateAt","desc").get().then(function(e){e.forEach(function(e){o=[].concat(Object(P.a)(o),[{id:e.id,data:e.data()}])})}).then(function(){r.collection("tasks").where("groupUid","==",e).where("status","==","assigned").orderBy("lastUpdateAt","desc").get().then(function(e){e.forEach(function(e){c=[].concat(Object(P.a)(c),[{id:e.id,data:e.data()}])})}).then(function(){r.collection("tasks").where("groupUid","==",e).where("status","==","pending").orderBy("lastUpdateAt","desc").get().then(function(e){e.forEach(function(e){i=[].concat(Object(P.a)(i),[{id:e.id,data:e.data()}])})}).then(function(){r.collection("tasks").where("groupUid","==",e).where("status","==","complete").orderBy("lastUpdateAt","desc").get().then(function(e){e.forEach(function(e){l=[].concat(Object(P.a)(l),[{id:e.id,data:e.data()}])})}).then(function(){t({type:"GET_TASKS",tasksData:s,unassignedTasksData:o,assignedTasksData:c,pendingTasksData:i,completeTasksData:l})})})})})})}).catch(function(e){console.log(e),t({type:"EMPTY_TASKS"})}):t({type:"EMPTY_TASKS"})}}(t))},fetchGroupDetails:function(t){return e(x(t))}}})(Y),J=a(372),H=a(237),X=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={title:"",content:"",category:"trash",expiryDate:new Date((new Date).getTime()+6048e5),verifybyImage:!1},a.handleBack=function(e){e.preventDefault(),window.location.href="#/"},a.handleChange=function(e){a.setState(Object(f.a)({},e.target.id,e.target.value))},a.toggleChange=function(){a.setState({verifybyImage:!a.state.verifybyImage})},a.handleDateChange=function(e){a.setState({expiryDate:e})},a.handleSubmit=function(e){e.preventDefault(),a.props.createTask(a.state)},a.handleAlert=function(e){a.props.confirmTaskAlert()},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.expiryDate;return r.a.createElement("div",{className:""},this.props.taskErr?r.a.createElement("div",{className:"popup-layer"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"information-window"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"alert-icon"},r.a.createElement(j.a,{icon:D.f})),r.a.createElement("h2",null,"Error"),r.a.createElement("h4",null,"The field of title cannot be empty"),r.a.createElement("hr",null),r.a.createElement("button",{className:"medium-button",onClick:this.handleAlert},"OK"))))):null,r.a.createElement("div",{className:"container"},r.a.createElement("h2",{className:"sub-instruciton-title"},"Post a task"),r.a.createElement("form",{className:"signinform",onSubmit:this.handleSubmit},r.a.createElement("label",{className:"label-font",htmlFor:"title"},"Title"),r.a.createElement("div",{className:"task-input-row"},r.a.createElement("input",{type:"test",id:"title",onChange:this.handleChange})),r.a.createElement("label",{className:"label-font",htmlFor:"expiryDate"},"Expiry Date"),r.a.createElement("div",{className:"task-input-row"},r.a.createElement(H.b,{id:"expiryDate",utils:J.a},r.a.createElement("div",{className:"pickers"},r.a.createElement(H.a,{id:"inputdate",className:"input-date browser-default",value:e,onChange:this.handleDateChange})))),r.a.createElement("label",{className:"label-font",htmlFor:"expiryDate"},"Category"),r.a.createElement("div",{className:"task-input-row"},r.a.createElement("select",{value:this.state.value,name:"",id:"category",onChange:this.handleChange},r.a.createElement("option",{value:"trash"},"Trash"),r.a.createElement("option",{value:"clean"},"Clean"),r.a.createElement("option",{value:"bathroom"},"Bathroom"),r.a.createElement("option",{value:"kitchen"},"Kitchen"),r.a.createElement("option",{value:"floor"},"Floor"),r.a.createElement("option",{value:"other"},"Other"))),r.a.createElement("label",{className:"label-font",htmlFor:"verifybyImage"},"Verification condition"),r.a.createElement("div",{className:"checkbox-wrapper"},r.a.createElement("div",{className:"task-checkboxinput-row"},r.a.createElement("input",{type:"checkbox",id:"verifybyImage",checked:this.state.verifybyImage,onChange:this.toggleChange}),r.a.createElement("span",{className:"checkmark "})),r.a.createElement("div",{className:"checkbox-text"},"Photo proof")),r.a.createElement("label",{className:"label-font",htmlFor:"content"},"Description"),r.a.createElement("div",{className:"textarea-row"},r.a.createElement("textarea",{type:"text",id:"content",onChange:this.handleChange})),r.a.createElement("div",{className:"feature-row"},r.a.createElement("button",{onClick:this.handleBack,className:"medium-square-button cancel-button"},"Back"),r.a.createElement("button",{className:"medium-square-button"},"Save")))))}}]),t}(n.Component),z=Object(h.b)(function(e){return{taskErr:e.task.err}},function(e){return{createTask:function(t){return e(function(e){return function(t,a,n){n.getFirebase;var r=(0,n.getFirestore)(),s=a().firebase.profile,o=a().firebase.auth.uid;0!==e.title.length?r.collection("tasks").add(Object(g.a)({},e,{author:s.firstname,authorUid:o,authorPhotoURL:s.photoURL||null,authorColor:s.userColor||null,groupUid:s.defaultGroup,createAt:new Date,assign:{assignedTo:null,assignedAt:null},approve:{verifiedBy:null,verifiedAt:null},lastUpdateAt:r.FieldValue.serverTimestamp(),status:"unassigned"})).then(function(){t({type:"CREATE_TASK",task:e})}).then(function(){window.location.hash="#/"}).catch(function(e){t({type:"CREATE_TASK_ERROR",err:e})}):t({type:"TASK_BLANK"})}}(t))},confirmTaskAlert:function(){return e(function(e,t,a){a.getFirebase,a.getFirestore,e({type:"RESET_TASK_ALERT"})})}}})(X),Z=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"bouncing-loader"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)))}}]),t}(n.Component),Q=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleBack=function(e){e.preventDefault(),window.location.href="#/"},a.handleAccept=function(e){a.props.acceptTask(a.props.match.params.id)},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchTask(this.props.match.params.id)}},{key:"componentWillUnmount",value:function(){this.props.fetchTask()}},{key:"render",value:function(){var e=this.props.match.params.id;if(this.props.taskdetails.data){var t=this.props.taskdetails.data,a=t.expiryDate,n=t.author,s=t.content,o=t.title;return r.a.createElement("div",{className:"taskdetails-wrapper",key:e},r.a.createElement("div",{className:"container "},r.a.createElement("h2",{className:"sub-instruciton-title"},"Accept the Task"),r.a.createElement("div",{className:"task-card"},r.a.createElement("h2",{className:"title"},o),r.a.createElement("p",{className:"expirydate"},"Expiry Date | ",a.toDate().toTimeString().replace("GMT+0800 (Taipei Standard Time)","")+" "+a.toDate().toDateString()),r.a.createElement("p",{className:"expirydate"},"Posted by | ",n),r.a.createElement("p",null,s))),r.a.createElement("div",{className:"feature-row"},r.a.createElement("button",{onClick:this.handleBack,className:"medium-square-button cancel-button"},"Back"),r.a.createElement("button",{onClick:this.handleAccept,className:"medium-square-button"},"Accept")))}return r.a.createElement(Z,null)}}]),t}(n.Component),$=Object(h.b)(function(e,t){return{taskdetails:e.task.taskData?e.task.taskData:null}},function(e){return{fetchTask:function(t){return e(K(t))},acceptTask:function(t){return e(function(e){return function(t,a,n){n.getFirebase;var r=(0,n.getFirestore)(),s=a().firebase.auth.uid,o=a().firebase.profile,c=a().firebase.profile.firstname,i=a().firebase.profile.defaultGroup;r.collection("tasks").doc(e).update({assign:{assignedAt:r.FieldValue.serverTimestamp(),assignedTo:c,assignedToUid:s,assignedToURL:o.photoURL||null,assignedToColor:o.userColor||null},lastUpdateAt:r.FieldValue.serverTimestamp(),status:"assigned"}).then(function(){r.collection("users").doc(s).update(Object(f.a)({},"beAssignedTo.".concat(i),r.FieldValue.arrayUnion(e))).then(function(){t({type:"EMPTY_TASKS"})}).then(function(){window.location.hash="#/"})}).catch(function(e){console.log(e)})}}(t))}}})(Q),ee=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleAlert=function(e){a.props.confirmTaskAlert()},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"popup-layer"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"information-window"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"alert-icon"},r.a.createElement(j.a,{icon:D.f})),r.a.createElement("h2",null,"Error"),r.a.createElement("h4",null,this.props.errorMessage),r.a.createElement("hr",null),r.a.createElement("button",{className:"medium-button",onClick:this.handleAlert},"OK")))))}}]),t}(n.Component),te=Object(h.b)(function(e){return{errorMessage:e.task.errMessage}},function(e){return{confirmTaskAlert:function(){return e(function(e,t,a){a.getFirebase,a.getFirestore,e({type:"RESET_TASK_ALERT"})})}}})(ee),ae=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={files:[],imagePreviewUrl:[],imagefile:null},a.handleBack=function(e){e.preventDefault(),window.location.href="#/"},a.handleChange=function(e){a.setState({files:e.target.files,imagePreviewUrl:URL.createObjectURL(e.target.files[0]),file:e.target.files[0]})},a.handleReportWithImage=function(e){e.preventDefault();var t=a.props.match.params.id,n=a.props.taskdetails.data.assign;a.props.reportTaskWithImage(t,n,a.state.file)},a.handleReport=function(e){e.preventDefault();var t=a.props.match.params.id,n=a.props.taskdetails.data.assign;a.props.reportTaskWOImage(t,n)},a.fileInput=r.a.createRef(),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchTask(this.props.match.params.id)}},{key:"componentWillUnmount",value:function(){this.props.fetchTask()}},{key:"render",value:function(){var e=this.props.match.params.id;if(this.props.taskdetails.data){var t=this.props.taskdetails.data,a=t.verifybyImage,n=t.expiryDate,s=t.assign,o=t.author,c=t.content,i=t.title;return r.a.createElement("div",null,this.props.taskErr?r.a.createElement(te,{error:this.props.match.params.id}):null,r.a.createElement("div",{className:"taskdetails-wrapper",key:e},r.a.createElement("div",{className:"container "},r.a.createElement("h2",{className:"sub-instruciton-title"},"Report the Task"),r.a.createElement("div",{className:"task-card"},r.a.createElement("h2",{className:"title"},i),r.a.createElement("p",{className:"expirydate"},"Expiry Date | ",n.toDate().toTimeString().replace("GMT+0800 (Taipei Standard Time)","")+" "+n.toDate().toDateString()),r.a.createElement("p",{className:"expirydate"},"Posted by | ",o),r.a.createElement("p",{className:"expirydate"},"Assigned to | ",s.assignedTo),r.a.createElement("p",{className:"expirydate"},"Description"),r.a.createElement("p",null,c),this.state.imagePreviewUrl[0]&&r.a.createElement("div",null,r.a.createElement("p",{className:"expirydate"},"Image attachment"),r.a.createElement("div",{className:"image-row"},r.a.createElement("div",{className:"image-box"},r.a.createElement("div",{className:"image-box-inner"},r.a.createElement("img",{className:"",src:this.state.imagePreviewUrl,alt:""})))))),a?r.a.createElement("div",{className:"uploadwrapper"},r.a.createElement("form",{action:"",onSubmit:this.handleReportWithImage},r.a.createElement("div",{className:"task-input-row"},r.a.createElement("label",{htmlFor:"imagefile"},"attachment"),r.a.createElement("input",{id:"imagefile",type:"file",onChange:this.handleChange,ref:this.fileInput})),r.a.createElement("div",{className:"feature-row"},r.a.createElement("button",{onClick:this.handleBack,className:"medium-square-button cancel-button"},"Back"),r.a.createElement("button",{className:"medium-square-button"},"Finish")))):r.a.createElement("div",{className:"uploadwrapper"},r.a.createElement("form",{action:"",onSubmit:this.handleReport},r.a.createElement("div",{className:"feature-row"},r.a.createElement("button",{onClick:this.handleBack,className:"medium-square-button cancel-button"},"Back"),r.a.createElement("button",{className:"medium-square-button"},"Finish")))))))}return r.a.createElement(Z,null)}}]),t}(n.Component),ne=Object(h.b)(function(e,t){return{taskdetails:e.task.taskData?e.task.taskData:null,taskErr:e.task.err}},function(e){return{fetchTask:function(t){return e(K(t))},reportTaskWithImage:function(t,a,n){return e(function(e,t,a){return function(n,r,s){s.getFirebase;var o=(0,s.getFirestore)(),c=r().firebase.profile.defaultGroup,i=r().firebase.auth.uid,l=t.assignedToUid;if(i===l)if(a){var u=M.ref("task_images/".concat(e)).child(a.name);u.put(a).then(function(t){u.getDownloadURL().then(function(t){o.collection("tasks").doc(e).update({lastUpdateAt:o.FieldValue.serverTimestamp(),finishAt:o.FieldValue.serverTimestamp(),status:"pending",pendingImgURL:t}).then(function(){var t;o.collection("users").doc(i).update((t={},Object(f.a)(t,"beAssignedTo.".concat(c),o.FieldValue.arrayRemove(e)),Object(f.a)(t,"pending.".concat(c),o.FieldValue.arrayUnion(e)),t)).then(function(){n({type:"EMPTY_TASKS"})}).then(function(){window.location.hash="#/"}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e),alert("upload failed, please try again")})}).catch(function(e){console.log(e),alert("upload failed, please try again")})}else console.log("\u6c92\u6709\u4e0a\u50b3\u5716\u7247"),n({type:"TASK_BLANK_NOPIC"});else n({type:"TASK_NOT_ASSIGNED"})}}(t,a,n))},reportTaskWOImage:function(t,a){return e(function(e,t){return function(a,n,r){r.getFirebase;var s=(0,r.getFirestore)(),o=n().firebase.profile.defaultGroup,c=n().firebase.auth.uid,i=t.assignedToUid;c===i?s.collection("tasks").doc(e).update({lastUpdateAt:s.FieldValue.serverTimestamp(),finishAt:s.FieldValue.serverTimestamp(),status:"pending"}).then(function(){var t;s.collection("users").doc(c).update((t={},Object(f.a)(t,"beAssignedTo.".concat(o),s.FieldValue.arrayRemove(e)),Object(f.a)(t,"pending.".concat(o),s.FieldValue.arrayUnion(e)),t)).then(function(){a({type:"EMPTY_TASKS"})}).then(function(){window.location.hash="#/"}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)}):a({type:"TASK_NOT_ASSIGNED"})}}(t,a))}}})(ae),re=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleBack=function(e){e.preventDefault(),window.location.href="#/"},a.handleApprove=function(e){var t=a.props.taskdetails.data.assign;a.props.approveTask(a.props.match.params.id,t)},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchTask(this.props.match.params.id)}},{key:"componentWillUnmount",value:function(){this.props.fetchTask()}},{key:"render",value:function(){var e=this.props.match.params.id;if(this.props.taskdetails.data){var t=this.props.taskdetails.data,a=t.content,n=t.expiryDate,s=t.pendingImgURL,o=t.assign,c=t.author,i=t.title;return r.a.createElement("div",{className:"taskdetails-wrapper",key:e},r.a.createElement("div",{className:"container "},r.a.createElement("h2",{className:"sub-instruciton-title"},"Approve the Task"),r.a.createElement("div",{className:"task-card"},r.a.createElement("h2",{className:"title"},i),r.a.createElement("p",{className:"expirydate"},"Expiry Date | ",n.toDate().toTimeString().replace("GMT+0800 (Taipei Standard Time)","")+" "+n.toDate().toDateString()),r.a.createElement("p",{className:"expirydate"},"Assigned to | ",o.assignedTo),r.a.createElement("p",{className:"expirydate"},"Posted by | ",c),r.a.createElement("p",{className:"expirydate"},"Description"),r.a.createElement("p",null,a),s?r.a.createElement("div",null,r.a.createElement("p",{className:"expirydate"},"Image attachment"),r.a.createElement("div",{className:"image-row"},r.a.createElement("div",{className:"image-box"},r.a.createElement("div",{className:"image-box-inner"},r.a.createElement("img",{className:"",src:s,alt:""}))))):null)),r.a.createElement("div",{className:"feature-row"},r.a.createElement("button",{onClick:this.handleBack,className:"medium-square-button cancel-button"},"Back"),r.a.createElement("button",{onClick:this.handleApprove,className:"medium-square-button"},"Approve")))}return r.a.createElement(Z,null)}}]),t}(n.Component),se=Object(h.b)(function(e,t){return{taskdetails:e.task.taskData?e.task.taskData:null}},function(e){return{fetchTask:function(t){return e(K(t))},approveTask:function(t,a){return e(function(e,t){return function(a,n,r){r.getFirebase;var s,o=(0,r.getFirestore)(),c=n().firebase.profile.defaultGroup,i=n().firebase.profile.firstname,l=n().firebase.profile,u=n().firebase.auth.uid,m=t.assignedToUid;u!==m?o.collection("groups").doc(c).get().then(function(e){var t=e.data().pointsRecord;return s=t[m].points+1}).then(function(){o.collection("groups").doc(c).update(Object(f.a)({},"pointsRecord.".concat(m,".points"),s)).then(function(){o.collection("tasks").doc(e).update({lastUpdateAt:o.FieldValue.serverTimestamp(),status:"complete",approve:{approvedAt:o.FieldValue.serverTimestamp(),approvedBy:i,approvedByURL:l.photoURL||null,approvedByColor:l.userColor||null}}).then(function(){var t;o.collection("users").doc(m).update((t={},Object(f.a)(t,"pending.".concat(c),o.FieldValue.arrayRemove(e)),Object(f.a)(t,"finish.".concat(c),o.FieldValue.arrayUnion(e)),t)).then(function(){a({type:"EMPTY_TASKS"})}).then(function(){window.location.hash="#/"}).catch(function(e){return console.log(e)})}).catch(function(e){return console.log(e)})}).catch(function(e){return console.log(e)})}).catch(function(e){return console.log(e)}):alert("It is an invalid action")}}(t,a))}}})(re),oe=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={groupName:"",groupId:"",groupPassword:""},a.handleChange=function(e){a.setState(Object(f.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.props.signUpGroup(a.state)},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"formoutter"},r.a.createElement("div",{className:"formwrapper-bottom"},r.a.createElement("form",{className:"signinform",onSubmit:this.handleSubmit},r.a.createElement("label",{className:"label-font",htmlFor:"groupName"},"Group Name"),r.a.createElement("div",{className:"input-row"},r.a.createElement("input",{type:"text",id:"groupName",onChange:this.handleChange})),r.a.createElement("label",{className:"label-font",htmlFor:"groupId"},"Group ID"),r.a.createElement("div",{className:"input-row"},r.a.createElement("input",{type:"text",id:"groupId",onChange:this.handleChange})),r.a.createElement("label",{className:"label-font",htmlFor:"groupPassword"},"Group Password"),r.a.createElement("div",{className:"input-row"},r.a.createElement("input",{type:"password",id:"groupPassword",onChange:this.handleChange})),r.a.createElement("div",{className:"text-row error-holder"},this.props.groupError?r.a.createElement("p",{className:"alert-font"},this.props.groupError):null),r.a.createElement("div",{className:"feature-row"},r.a.createElement("button",{className:"medium-button"},"Create Group")))))}}]),t}(n.Component),ce=Object(h.b)(function(e){return{auth:e.firebase.auth,groupError:e.auth.groupError}},function(e){return{signUpGroup:function(t){return e(function(e){return function(t,a,n){n.getFirebase;var r=(0,n.getFirestore)(),s=a().firebase.auth.uid,o=a().firebase.profile,c=!0,i=e.groupName,l=e.groupId,u=e.groupPassword;0!==i.length&&0!==l.length&&0!==u.length?r.collection("groups").where("groupId","==",e.groupId).get().then(function(e){e.forEach(function(e){e.data()&&(c=!1)})}).then(function(){c||t({type:"SIGNUPGROUP_ERROR"}),c&&r.collection("groups").add(Object(g.a)({},e,{members:r.FieldValue.arrayUnion(s)})).then(function(e){var t,a=e.id;r.collection("users").doc(s).update({groupsUid:r.FieldValue.arrayUnion(a),defaultGroup:a}),r.collection("groups").doc(a).update((t={groupUid:a},Object(f.a)(t,"pointsRecord.".concat(s),{firstname:o.firstname,userColor:o.userColor||null,points:0,userUid:s}),Object(f.a)(t,"membersInfo.".concat(s),{firstname:o.firstname,userColor:o.userColor||null,photoURL:"".concat(o.photoURL)||null,userUid:s}),t))}).then(t({type:"SIGNUPGROUP_SUCCESS"})).then(function(){window.location.hash="#/"})}):t({type:"SIGNINGROUP_EMPTY"})}}(t))}}})(oe),ie=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={groupId:"",groupPassword:""},a.handleChange=function(e){a.setState(Object(f.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.props.signInGroup(a.state)},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"formoutter"},r.a.createElement("div",{className:"formwrapper-bottom"},r.a.createElement("form",{className:"signinform",onSubmit:this.handleSubmit},r.a.createElement("label",{className:"label-font",htmlFor:"groupId"},"Group ID"),r.a.createElement("div",{className:"input-row"},r.a.createElement("input",{type:"text",id:"groupId",onChange:this.handleChange})),r.a.createElement("label",{className:"label-font",htmlFor:"groupPassword"},"Password"),r.a.createElement("div",{className:"input-row"},r.a.createElement("input",{type:"password",id:"groupPassword",onChange:this.handleChange})),r.a.createElement("div",{className:"text-row error-holder"},this.props.groupError?r.a.createElement("p",{className:"alert-font"},this.props.groupError):null),r.a.createElement("div",{className:"feature-row"},r.a.createElement("button",{className:"medium-button"},"Join Group")))))}}]),t}(n.Component),le=Object(h.b)(function(e){return{groupError:e.auth.groupError}},function(e){return{signInGroup:function(t){return e((a=t,function(e,t,n){n.getFirebase;var r=n.getFirestore,s=a.groupId,o=a.groupPassword,c=r(),i=t().firebase.auth.uid,l=t().firebase.profile,u=!1,m=null;0!==s.length&&0!==o.length?c.collection("groups").where("groupId","==",a.groupId).get().then(function(t){0===t.docs.length&&e({type:"SIGNINGROUP_NOTEXIST"}),1===t.docs.length&&t.forEach(function(t){if(t.data()){m=t.id;var n=t.data(),r=n.members,s=n.groupPassword;s!==a.groupPassword&&e({type:"SIGNINGROUP_ERROR"}),s===a.groupPassword&&(-1===r.indexOf(i)?u=!0:e({type:"SIGNINGROUP_ERROR_EXIST"}))}})}).then(function(){var e;u&&i&&c.collection("groups").doc(m).update((e={},Object(f.a)(e,"pointsRecord.".concat(i),{firstname:l.firstname,userColor:l.userColor||null,points:0,userUid:i}),Object(f.a)(e,"members",c.FieldValue.arrayUnion(i)),Object(f.a)(e,"membersInfo.".concat(i),{firstname:l.firstname,userColor:l.userColor||null,photoURL:"".concat(l.photoURL)||null,userUid:i}),e)).catch(function(e){return console.log(e)})}).then(function(){u&&i&&c.collection("users").doc(i).update({groupsUid:c.FieldValue.arrayUnion(m),defaultGroup:m}).catch(function(e){return console.log(e)})}).then(function(){u&&i&&e({type:"SIGNINGROUP_SUCCESS"})}).then(function(){u&&i&&(window.location.hash="#/")}).catch(function(e){return console.log(e)}):e({type:"SIGNINGROUP_EMPTY"})}));var a}}})(ie),ue=function(){return r.a.createElement("div",{className:"container"},r.a.createElement("h2",{className:"sub-instruciton-title"},"Join the Homie Group"),r.a.createElement("div",{className:"formoutter"},r.a.createElement("div",{className:"formwrapper-top "},r.a.createElement("div",{className:"link-wrapper"},r.a.createElement(p.c,{className:"signgroup-tab",activeClassName:"signgroup-tab-active",to:"/signgroup/signup"},"Create Group"),r.a.createElement(p.c,{className:"signgroup-tab",activeClassName:"signgroup-tab-active",to:"/signgroup/signin"},"Join Group")))),r.a.createElement(d.b,{path:"/signgroup/signup",component:ce}),r.a.createElement(d.b,{path:"/signgroup/signin",component:le}))},me=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement("div",{className:"app"},r.a.createElement(y,null),r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",component:q}),r.a.createElement(d.b,{path:"/signin",component:w}),r.a.createElement(d.b,{exact:!0,path:"/task/:id",component:$}),r.a.createElement(d.b,{exact:!0,path:"/task/memo/:id",component:ne}),r.a.createElement(d.b,{exact:!0,path:"/task/process/:id",component:se}),r.a.createElement(d.b,{path:"/signup",component:function(){return r.a.createElement(S,null)}}),r.a.createElement(d.b,{path:"/post",component:z}),r.a.createElement(d.b,{path:"/signgroup",component:ue}))))}}]),t}(r.a.Component),pe=a(64),de=a(370),he={authError:null,groupError:null},ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_ERROR":return console.log("login error"),Object(g.a)({},e,{authError:"Login failed"});case"LOGIN_SUCCESS":return console.log("login success"),Object(g.a)({},e,{authError:null});case"SIGNOUT_SUCCESS":return console.log("signout success"),e;case"SIGNUP_SUCCESS":return console.log("signup success and login"),Object(g.a)({},e,{authError:null});case"SIGNUP_ERROR":return console.log("signup error"),Object(g.a)({},e,{authError:t.err.message});case"SIGNINGROUP_SUCCESS":return console.log("signin group success"),Object(g.a)({},e,{groupError:null});case"SIGNINGROUP_NOTEXIST":return console.log("This group id was not exist"),Object(g.a)({},e,{groupError:"This group id was not exist"});case"SIGNINGROUP_EMPTY":return console.log("All fields are required"),Object(g.a)({},e,{groupError:"All fields are required"});case"SIGNINGROUP_ERROR":return console.log("The password is incorrect"),Object(g.a)({},e,{groupError:"That was an invalid password"});case"SIGNINGROUP_ERROR_EXIST":return console.log("This member already exist"),Object(g.a)({},e,{groupError:"You have been already joined this group"});case"SIGNUPGROUP_SUCCESS":return console.log("signup group success"),Object(g.a)({},e,{groupError:null});case"SIGNUPGROUP_ERROR":return console.log("signup group error"),Object(g.a)({},e,{groupError:"This group id is already in use by another account"});default:return e}},fe={tasks:[],tasksData:[],taskData:[],unassignedTasksData:[],assignedTasksData:[],pendingTasksData:[],completeTasksData:[],complete:!1,err:!1,errMessage:null},Ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_TASK":return console.log("create task",t.task),e;case"TASK_BLANK":return Object(g.a)({},e,{err:!0});case"TASK_BLANK_NOPIC":return Object(g.a)({},e,{err:!0,errMessage:"This task cannot report without a photo."});case"TASK_NOT_ASSIGNED":return Object(g.a)({},e,{err:!0,errMessage:"You are not assigned to this task"});case"RESET_TASK_ALERT":return Object(g.a)({},e,{err:!1,errMessage:null});case"CREATE_TASK_ERROR":return console.log("create task",t.err),e;case"GET_TASKS":return Object(g.a)({},e,{tasksData:t.tasksData,unassignedTasksData:t.unassignedTasksData,assignedTasksData:t.assignedTasksData,pendingTasksData:t.pendingTasksData,completeTasksData:t.completeTasksData,complete:!0});case"GET_TASK":return Object(g.a)({},e,{taskData:t.taskData});case"EMPTY_TASK":return Object(g.a)({},e,{taskData:[]});case"EMPTY_TASKS":return Object(g.a)({},e,{tasksData:[],unassignedTasksData:[],assignedTasksData:[],pendingTasksData:[],completeTasksData:[],complete:!1});default:return e}},be={groups:null,switchError:null,defaultGroupData:null},ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GROUP_ADD":return Object(g.a)({},e,{groups:t.groupsData});case"SWITCHGROUP_SUCCESS":return e;case"SWITCHGROUP_ERROR":return Object(g.a)({},e,{switchError:t.error});case"GET_GROUP":return Object(g.a)({},e,{defaultGroupData:t.groupData});case"GET_GROUP_EMPTY":return Object(g.a)({},e,{defaultGroupData:null});default:return e}},Ne=a(113),ke=a(114),ye=Object(pe.combineReducers)({auth:ge,task:Ee,group:ve,firestore:Ne.firestoreReducer,firebase:ke.firebaseReducer}),Oe=a(371),we=Object(pe.createStore)(ye,Object(de.composeWithDevTools)(Object(pe.applyMiddleware)(Oe.a.withExtraArgument({getFirestore:Ne.getFirestore,getFirebase:ke.getFirebase})),Object(Ne.reduxFirestore)(B.a),Object(ke.reactReduxFirebase)(B.a,{useFirestoreForProfile:!0,userProfile:"users",attachAuthIsReady:!0,firebaseStateName:"firebase"})));we.firebaseAuthIsReady.then(function(){o.a.render(r.a.createElement(h.a,{store:we},r.a.createElement(me,null)),document.getElementById("root"))})}},[[373,1,2]]]);
//# sourceMappingURL=main.93877b69.chunk.js.map